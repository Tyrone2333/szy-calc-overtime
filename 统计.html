<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <title>统计</title>
    <style></style>

</head>
<body>

<script>
    // 加班开始时间
    const overtimeStartTime = "18:00"
    // 月工资
    const monthlySalary = 10000
    // 时薪
    const hourlySalary = monthlySalary / 21.75 / 8
    fetch('./考勤统计.json', {
        method: 'GET',
        headers: {
            'Accept': 'application/json, text/plain, */*',
            'Content-Type': 'application/json',
        },
    }).then(function (response) {
        return response.json()
    }).then(function (data) {
        console.log('原始记录', data)
        window.document.writeln((JSON.stringify(data)))

        // 工作日加班数组
        let workingDayOvertimeList = []
        workingDayOvertimeList = data.filter((item) => {
            // console.log(item)
            let date = item.start.substring(0, 10)

            // fdWorkType: 0-上班 1-下班
            // if 下班item && 打卡大于下班时间 && 工作日
            if (item.fdWorkType === 1 && item.attendTime > overtimeStartTime && [1, 2, 3, 4, 5].includes(new Date(item.start).getDay())) {
                // 计算加班时长(单位: 小时) 签到时间 - 加班开始时间
                item.overtimeHours = (new Date('2020 01 01 ' + item.attendTime).getTime() - new Date('2020 01 01 ' + overtimeStartTime).getTime()) / (1000 * 60 * 60)
                return true
            }
        })
        let count = 0
        workingDayOvertimeList.forEach((item) => {
            count += item.overtimeHours
        })

        console.log('工作日加班数组', workingDayOvertimeList)
        console.log('加班开始时间', overtimeStartTime)
        console.log('工作日加班总时长', count)
        console.log(`月工资: ${monthlySalary},日薪: ${monthlySalary / 21.75},时薪: ${hourlySalary}`)
        console.log('工作日加班工资合计(日薪*加班时长*1.5)', hourlySalary * count * 1.5)
    })
</script>
</body>
</html>
